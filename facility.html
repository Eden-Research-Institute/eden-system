<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EDEN INSTITUTE - FACILITY</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=JetBrains+Mono:wght@400;700&display=swap');

        :root {
            --bg-color: #121212; --sidebar-bg: #1e1e1e; --card-bg: #252525;
            --border: #333; --accent: #00ff9d; --danger: #ff4b4b; --warning: #ffaa00; --text-main: #ffffff; --text-sub: #888;
        }

        * { box-sizing: border-box; }
        body { margin: 0; padding: 0; background-color: var(--bg-color); color: var(--text-main); font-family: 'Inter', sans-serif; min-height: 100vh; overflow-x: hidden; }
        .mono { font-family: 'JetBrains Mono', monospace; }

        /* ÏÇ¨Ïù¥ÎìúÎ∞î */
        .sidebar { width: 240px; height: 100vh; background-color: var(--sidebar-bg); border-right: 1px solid var(--border); position: fixed; top: 0; left: 0; display: flex; flex-direction: column; padding: 20px; z-index: 100; overflow-y: auto; }
        .logo { font-size: 16px; font-weight: 700; color: var(--accent); letter-spacing: 2px; margin-bottom: 40px; display: flex; align-items: center; gap: 10px; }
        .logo::before { content: '‚ùñ'; font-size: 20px; }
        .menu-item { padding: 12px 15px; color: var(--text-sub); border-radius: 6px; margin-bottom: 4px; transition: 0.2s; font-size: 14px; display: flex; align-items: center; gap: 12px; font-weight: 500; text-decoration: none; }
        .menu-item:hover, .menu-item.active { background-color: rgba(0, 255, 157, 0.05); color: var(--accent); }
        .profile-box { margin-top: auto; padding-top: 20px; border-top: 1px solid var(--border); display: flex; align-items: center; gap: 12px; }
        .avatar { width: 32px; height: 32px; background: #333; border-radius: 4px; display: flex; justify-content: center; align-items: center; font-weight: bold; color: #fff; font-size: 14px; }
        .user-info { cursor: pointer; }
        .user-info h4 { margin: 0; font-size: 13px; color: #fff; font-weight: 600; }
        .user-info p { margin: 0; font-size: 11px; color: var(--danger); margin-top: 3px; font-weight: bold;}

        /* Î©îÏù∏ ÏΩòÌÖêÏ∏† */
        .main-content { margin-left: 240px; padding: 30px; display: flex; flex-direction: column; gap: 20px; min-height: 100vh; }
        .header-area { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 10px; border-bottom: 1px solid var(--border); padding-bottom: 15px; }
        .page-title h1 { margin: 0; font-size: 20px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px;}
        .page-title p { margin: 5px 0 0; color: var(--text-sub); font-size: 12px; }
        .clock-area { text-align: right; display: block !important; }
        .clock-time { font-size: 24px; font-weight: 600; color: var(--text-main); letter-spacing: 1px; }
        .clock-date { font-size: 11px; color: var(--text-sub); margin-top: 2px; text-transform: uppercase; text-align: right;}

        /* Ïπ¥Îìú Î∞è Ï∏µÎ≥Ñ Íµ¨Ïó≠ */
        .floor-card { background-color: var(--card-bg); border: 1px solid var(--border); border-radius: 8px; padding: 25px; position: relative; margin-bottom: 20px; }
        .floor-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        .floor-title { font-size: 16px; font-weight: 700; color: #fff; display: flex; align-items: center; gap: 10px; }
        .floor-tag { font-size: 11px; padding: 3px 8px; border-radius: 4px; background: #333; color: #aaa; font-weight: normal; }
        
        .zone-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }
        .zone-box { background: rgba(0,0,0,0.2); border: 1px solid #444; border-radius: 6px; padding: 15px; display: flex; flex-direction: column; gap: 8px; transition: 0.2s; min-height: 80px; position: relative; }
        .zone-box:hover { border-color: var(--accent); background: rgba(0, 255, 157, 0.05); }
        .zone-name { font-size: 13px; color: #ccc; font-weight: 600; margin-bottom: 5px;}
        
        .occupancy { display: flex; flex-direction: column; gap: 4px; font-size: 12px; margin-top: auto; }
        .occ-item { display: flex; align-items: center; gap: 6px; }
        .icon-staff { color: #4facfe; } 
        .icon-sub { color: #ffaa00; } 
        
        /* ÌäπÏàò Î∞∞ÏßÄ (Ïπ¥Ïù¥Î°ú/Î¶¨ÌîåÎ¶¨) */
        .special-badge { display: inline-flex; align-items: center; gap: 5px; padding: 4px 8px; border-radius: 4px; font-weight: bold; font-size: 11px; width: fit-content; margin-bottom: 2px; box-shadow: 0 2px 5px rgba(0,0,0,0.5); }
        .badge-kairo { background: rgba(255, 75, 75, 0.2); color: var(--danger); border: 1px solid var(--danger); animation: kairo-pulse 3s infinite; }
        .badge-ripley { background: rgba(0, 255, 157, 0.2); color: var(--accent); border: 1px solid var(--accent); animation: pulse 2s infinite; }
        
        @keyframes pulse { 0% { opacity: 1; box-shadow: 0 0 5px var(--accent); } 50% { opacity: 0.7; box-shadow: none; } 100% { opacity: 1; box-shadow: 0 0 5px var(--accent); } }
        @keyframes kairo-pulse { 0% { border-color: var(--danger); } 50% { border-color: #fff; } 100% { border-color: var(--danger); } }

        .sec-1 { border: 1px solid #4facfe; color: #4facfe; } 
        .sec-2 { border: 1px solid #ffaa00; color: #ffaa00; } 
        .sec-3 { border: 1px solid var(--danger); color: var(--danger); } 

        /* ÏÉÅÎã® ÏÉÅÌÉú Î∞∞ÎÑà */
        .status-banner { grid-column: 1 / -1; background: rgba(0,0,0,0.3); padding: 15px; border-radius: 6px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; font-size: 14px; border-left: 4px solid var(--danger); box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
        .kairo-status { color: #fff; font-weight: bold; display: flex; align-items: center; gap: 10px; }
        .time-cycle { font-size: 12px; color: #888; }

        @media (max-width: 768px) {
            .sidebar { width: 100%; height: 55px; flex-direction: row; align-items: center; border-right: none; border-bottom: 1px solid var(--border); position: sticky; top: 0; padding: 0 10px; padding-right: 130px; overflow-x: auto; white-space: nowrap; }
            .sidebar::-webkit-scrollbar { display: none; }
            .logo { display: none; }
            .menu-item { margin-bottom: 0; margin-right: 5px; background: #222; padding: 6px 10px; height: 36px; }
            .profile-box { position: fixed; top: 0; right: 0; width: 120px; height: 55px; background: #1a1a1a; border-left: 2px solid var(--border); border-top: none; display: flex !important; justify-content: center; z-index: 1000; padding: 0; margin: 0; box-shadow: -5px 0 10px rgba(0,0,0,0.5); }
            .main-content { margin-left: 0; padding: 15px; }
            .header-area { flex-direction: column; align-items: flex-start; gap: 5px; }
            .clock-area { text-align: left; margin-top: 5px; }
            .zone-grid { grid-template-columns: 1fr; } 
            .status-banner { flex-direction: column; align-items: flex-start; gap: 10px; }
        }
    </style>
</head>
<body>
    <nav class="sidebar">
        <div class="logo">EDEN LAB.</div>
        <a href="main.html" class="menu-item"><span>üìä</span> <span>ÎåÄÏãúÎ≥¥Îìú</span></a>
        <a href="subjects.html" class="menu-item"><span>üß¨</span> <span>Ïã§ÌóòÏ≤¥ Í¥ÄÎ¶¨</span></a>
        <a href="facility.html" class="menu-item active"><span>üè¢</span> <span>ÏãúÏÑ§ Í¥ÄÎ¶¨</span></a>
        <a href="staff.html" class="menu-item"><span>üë•</span> <span>Ï°∞ÏßÅ/Ïù∏ÏÇ¨</span></a>
        <a href="public.html" target="_blank" class="menu-item"><span>üåê</span> <span>ÎåÄÏô∏ ÌôàÌéòÏù¥ÏßÄ</span></a>
        <div class="profile-box">
            <div class="avatar">K</div>
            <div class="user-info" onclick="alert('üîí [ACCESS DENIED]\n\nÎ≥¥Ïïà ÏàòÏã†Ìï®ÏùÄ Î©îÏù∏ ÎåÄÏãúÎ≥¥Îìú(Main Console) ÌÑ∞ÎØ∏ÎÑêÏóêÏÑúÎßå\nÏ†ëÏÜç Î∞è Ìï¥ÎèÖÏù¥ Í∞ÄÎä•Ìï©ÎãàÎã§.\n\nÎ©îÏù∏ ÌôîÎ©¥ÏúºÎ°ú Ïù¥ÎèôÌï©ÎãàÎã§.'); location.href='main.html'"><h4>KAIRO</h4> <p style="color:var(--danger);">LEVEL 5</p></div>
        </div>
    </nav>

    <main class="main-content">
        <div class="header-area">
            <div class="page-title"><h1>Facility</h1> <p>INTERNAL STRUCTURE MAP & SENSORS</p></div>
            <div class="clock-area mono"><div class="clock-time" id="clock">00:00:00</div><div class="clock-date" id="date">YYYY-MM-DD</div></div>
        </div>

        <div class="status-banner mono" id="status-banner">
            </div>

        <div class="floor-card">
            <div class="floor-header"><div class="floor-title">3F <span class="floor-tag">Director's Floor</span></div><div class="floor-tag sec-3">RESTRICTED AREA (LV.5)</div></div>
            <div class="zone-grid mono" id="floor-3"></div>
        </div>

        <div class="floor-card">
            <div class="floor-header"><div class="floor-title">2F <span class="floor-tag">Research & Staff</span></div><div class="floor-tag sec-2">AUTHORIZED ONLY</div></div>
            <div class="zone-grid mono" id="floor-2"></div>
        </div>

        <div class="floor-card">
            <div class="floor-header"><div class="floor-title">1F <span class="floor-tag">Lobby & Medical</span></div><div class="floor-tag sec-1">COMMON AREA</div></div>
            <div class="zone-grid mono" id="floor-1"></div>
        </div>

        <div class="floor-card" style="border-left: 3px solid var(--accent);">
            <div class="floor-header"><div class="floor-title" style="color:var(--accent);">B1 <span class="floor-tag">Subject & Experiment</span></div><div class="floor-tag sec-3">BIOHAZARD / CONTROLLED</div></div>
            <div class="zone-grid mono" id="floor-b1"></div>
        </div>

        <div class="floor-card" style="border-left: 3px solid var(--danger);">
            <div class="floor-header"><div class="floor-title" style="color:#888;">B2 <span class="floor-tag">Disposal & Infra</span></div><div class="floor-tag sec-2">MAINTENANCE</div></div>
            <div class="zone-grid mono" id="floor-b2"></div>
        </div>
    </main>

    <script>
        function updateClock() {
            const now = new Date();
            const kstTime = now.toLocaleTimeString('en-GB', { timeZone: 'Asia/Seoul', hour12: false });
            const kstDate = now.toLocaleDateString('en-CA', { timeZone: 'Asia/Seoul' });
            document.getElementById('clock').innerText = kstTime;
            document.getElementById('date').innerText = kstDate;
        }
        setInterval(updateClock, 1000); updateClock();

        function rnd(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }

        function updateFacilityStatus() {
            const now = new Date();
            const hour = now.getHours();
            
            // 1. ÏãúÍ∞ÑÎåÄ Ï†ïÏùò (Ïä§ÏºÄÏ§Ñ Í∏∞Î∞ò)
            const isNight = (hour >= 23 || hour < 6); // 23:00 ~ 06:00 (Ï∑®Ïπ®/ÏïºÍ∞Ñ)
            const isMorning = (hour >= 6 && hour < 9); // 06:00 ~ 09:00 (Í∏∞ÏÉÅ/Ï∂úÍ∑º)
            const isWorkTime = (hour >= 9 && hour < 18); // 09:00 ~ 18:00 (ÏùºÍ≥º)
            
            // ‚òÖ Ï§ëÏöî: Ïã§ÌóòÏ≤¥ Í¥ÄÎ¶¨ Ïä§ÏºÄÏ§Ñ (14Ïãú Ïã§Ìóò) Ïó∞Îèô ‚òÖ
            const isExperimentTime = (hour >= 14 && hour < 16); 

            // 2. Ïπ¥Ïù¥Î°ú(Kairo) ÏúÑÏπò Î°úÏßÅ
            let kairoLocName = "";
            let kairoLocCode = ""; // zone id mapping

            if (isNight) {
                // Ïã¨Ïïº: Î¨¥Ï°∞Í±¥ Ïπ®Ïã§
                kairoLocName = "3F ÏÜåÏû• Ïπ®Ïã§ (Resting)";
                kairoLocCode = "f3_bedroom";
            } else if (isExperimentTime) {
                // Ïã§Ìóò ÏãúÍ∞Ñ (14~16Ïãú): B1 Í≤©Î¶¨Ïã§ Ï∞∏Í¥Ä
                kairoLocName = "B1 ÌäπÏàò Í≤©Î¶¨Ïã§ (Observation)";
                kairoLocCode = "fb1_iso";
            } else {
                // Í∑∏ Ïô∏: ÏßëÎ¨¥Ïã§
                kairoLocName = "3F ÏÜåÏû• ÏßëÎ¨¥Ïã§ (Working)";
                kairoLocCode = "f3_office";
            }

            // 3. Î¶¨ÌîåÎ¶¨(Ripley) ÏúÑÏπò Î°úÏßÅ
            let ripleyLocCode = "fb1_iso"; // Í∏∞Î≥∏: Í≤©Î¶¨Ïã§
            if (isExperimentTime) {
                ripleyLocCode = "fb1_lab1"; // Ïã§Ìóò ÏãúÍ∞ÑÏóêÎäî Ïã§ÌóòÏã§Î°ú Ïù¥Îèô
            }

            // 4. ÏßÅÏõê Ïàò Î°úÏßÅ (ÏïºÍ∞ÑÏóêÎäî 10%Îßå ÏûîÎ•ò)
            const staffMultiplier = isNight ? 0.1 : 1.0; 

            // 5. Î∞∞ÎÑà ÏóÖÎç∞Ïù¥Ìä∏
            const banner = document.getElementById('status-banner');
            let cycleText = isNight ? "NIGHT CYCLE (SECURITY ONLY)" : "DAY CYCLE (FULL OPERATION)";
            if(isExperimentTime) cycleText = "‚ö† CORE EXPERIMENT IN PROGRESS";
            
            banner.innerHTML = `
                <div class="time-cycle">${cycleText}</div>
                <div class="kairo-status">
                    <span style="color:var(--danger);">‚òÖ DIRECTOR KAIRO LOC:</span> 
                    <span style="border-bottom:1px solid var(--danger); font-size:16px;">${kairoLocName}</span>
                </div>
            `;

            // 6. Íµ¨Ïó≠ Îç∞Ïù¥ÌÑ∞ Ï†ïÏùò (ÏΩîÎìúÍ∞íÏúºÎ°ú Ï†úÏñ¥)
            // kairoLocCodeÏôÄ ÏùºÏπòÌïòÎ©¥ kairo: true
            const zones = {
                'f3': [
                    { id: 'f3_office', name: "ÏÜåÏû• ÏßëÎ¨¥Ïã§", staff: 0, kairo: (kairoLocCode === 'f3_office') },
                    { id: 'f3_bedroom', name: "ÏÜåÏû• Ïπ®Ïã§/ÏÑúÏû¨", staff: 0, kairo: (kairoLocCode === 'f3_bedroom') },
                    { id: 'f3_sec', name: "Î≥¥Ïïà Í¥ÄÏ†úÏã§", staff: Math.ceil(rnd(3, 5) * 1.0) }, // Î≥¥ÏïàÌåÄÏùÄ ÏïºÍ∞ÑÏóêÎèÑ ÏÉÅÏ£º
                    { id: 'f3_meet', name: "Ï†ëÍ≤¨Ïã§", staff: 0 }
                ],
                'f2': [
                    { name: "ÏÑ∏Ìè¨ Î∂ÑÏÑùÏã§", staff: Math.ceil(rnd(15, 25) * staffMultiplier) },
                    { name: "Ïú†Ï†ÑÏûê Î≥ÄÏù¥ Ïó∞Íµ¨Ïã§", staff: Math.ceil(rnd(20, 30) * staffMultiplier) },
                    { name: "Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑùÏã§", staff: Math.ceil(rnd(10, 15) * staffMultiplier) },
                    { name: "Ïó∞Íµ¨Ïõê ÏÇ¨Î¨¥Ïã§", staff: Math.ceil(rnd(30, 50) * staffMultiplier) }
                ],
                'f1': [
                    { name: "Ï§ëÏïô Î°úÎπÑ", staff: Math.ceil(rnd(4, 8) * staffMultiplier), sub: 0 },
                    { name: "Î≥¥Ïïà Í≤ÄÏÉâÎåÄ", staff: Math.ceil(rnd(4, 6) * 1.0) }, // Î≥¥Ïïà Ïú†ÏßÄ
                    { name: "Ï£º ÏùòÎ£åÎèô", staff: Math.ceil(rnd(10, 15) * staffMultiplier), sub: rnd(2, 5) },
                    { name: "ÏùëÍ∏â Ï≤òÏπòÏã§", staff: Math.ceil(rnd(2, 4) * staffMultiplier), sub: 0 }
                ],
                'fb1': [
                    { id: 'fb1_lab1', name: "Ï†ú1 Ï§ëÏïô Ïã§ÌóòÏã§", staff: Math.ceil(rnd(10, 15) * staffMultiplier), sub: 0, ripley: (ripleyLocCode === 'fb1_lab1') },
                    { name: "Ï†ú2 Ï§ëÏïô Ïã§ÌóòÏã§", staff: Math.ceil(rnd(8, 12) * staffMultiplier), sub: rnd(2, 4) },
                    { id: 'fb1_iso', name: "ÌäπÏàò Í≤©Î¶¨Ïã§ (R-001)", staff: 0, ripley: (ripleyLocCode === 'fb1_iso'), kairo: (kairoLocCode === 'fb1_iso') },
                    { name: "Í∞úÎ≥Ñ Í≤©Î¶¨Ïã§ (AÍµ¨Ïó≠)", staff: Math.ceil(rnd(2, 4) * staffMultiplier), sub: rnd(120, 130) },
                    { name: "Í∞úÎ≥Ñ Í≤©Î¶¨Ïã§ (BÍµ¨Ïó≠)", staff: Math.ceil(rnd(2, 4) * staffMultiplier), sub: rnd(120, 130) }
                ],
                'fb2': [
                    { name: "Ï§ëÏïô ÌèêÍ∏∞Î¨º Ï≤òÎ¶¨Ïû•", staff: Math.ceil(rnd(2, 5) * staffMultiplier), sub: rnd(1, 3) },
                    { name: "Ï†ÑÎ†• Í≥µÍ∏âÏã§", staff: Math.ceil(rnd(1, 2) * 1.0) },
                    { name: "Ï§ëÏïô ÏÑúÎ≤ÑÏã§", staff: Math.ceil(rnd(1, 2) * 1.0) }
                ]
            };

            // 7. ÌôîÎ©¥ Í∑∏Î¶¨Í∏∞ Ìï®Ïàò
            const draw = (containerId, zoneList) => {
                const container = document.getElementById(containerId);
                let html = '';
                zoneList.forEach(z => {
                    let icons = '';
                    // Ïπ¥Ïù¥Î°ú Î∞∞ÏßÄ
                    if (z.kairo) icons += `<div class="special-badge badge-kairo">‚òÖ KAIRO</div>`;
                    // Î¶¨ÌîåÎ¶¨ Î∞∞ÏßÄ
                    if (z.ripley) icons += `<div class="special-badge badge-ripley">‚ò£ ER-S-02-001</div>`;
                    // ÏßÅÏõê/Ïã§ÌóòÏ≤¥ Ïàò
                    if (z.staff > 0) icons += `<span class="occ-item icon-staff">üë§ Ïó∞Íµ¨Ïõê ${z.staff}Î™Ö</span>`;
                    if (z.sub > 0) icons += `<span class="occ-item icon-sub">üß¨ Ïã§ÌóòÏ≤¥ ${z.sub}Ï≤¥</span>`;
                    // ÎπàÎ∞© Ï≤òÎ¶¨
                    if (icons === '') icons = `<span style="color:#444; font-size:11px;">- Empty -</span>`;
                    
                    // Í∞ïÏ°∞ Ìö®Í≥º (Ïπ¥Ïù¥Î°úÍ∞Ä ÏûàÎäî Î∞©ÏùÄ ÌÖåÎëêÎ¶¨ Î∂âÍ≤å)
                    let boxStyle = z.kairo ? 'border-color:var(--danger); background:rgba(255, 75, 75, 0.05);' : '';

                    html += `<div class="zone-box" style="${boxStyle}">
                                <div class="zone-name">${z.name}</div>
                                <div class="occupancy">${icons}</div>
                             </div>`;
                });
                container.innerHTML = html;
            };

            draw('floor-3', zones.f3);
            draw('floor-2', zones.f2);
            draw('floor-1', zones.f1);
            draw('floor-b1', zones.fb1);
            draw('floor-b2', zones.fb2);
        }

        // Ï¥àÍ∏∞ Ïã§Ìñâ Î∞è 3Ï¥àÎßàÎã§ Í∞±Ïã† (ÏãúÍ∞Ñ Î≥ÄÌôî Í∞êÏßÄ)
        updateFacilityStatus();
        setInterval(updateFacilityStatus, 3000); 
    </script>
</body>
</html>
